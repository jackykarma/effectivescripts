#!/bin/bash
# 本脚本的功能是将hisi的edid读取的文本形式转化为KONKA HdmiEdid.bin文档的表示形式。
# 下面的内容是源hisi通过echo getedid > /proc/msp/hdmirx读取的EDID格式

#0x00,	0xFF,	0xFF,	0xFF,	0xFF,	0xFF,	0xFF,	0x00,	0x36,	0x74,	0x30,	0x00,	0x01,	0x00,	0x00,	0x00,
#0x0A,	0x18,	0x01,	0x03,	0x80,	0x73,	0x41,	0x78,	0x0A,	0xCF,	0x74,	0xA3,	0x57,	0x4C,	0xB0,	0x23,
#0x09,	0x48,	0x4C,	0x00,	0x00,	0x00,	0x01,	0x01,	0x01,	0xFF,	0x01,	0xFF,	0xFF,	0x01,	0x01,	0x01,
#0x01,	0x01,	0x01,	0x01,	0x01,	0x20,	0x08,	0xE8,	0x00,	0x30,	0xF2,	0x70,	0x5A,	0x80,	0xB0,	0x58,
#0x8A,	0x00,	0xC4,	0x8E,	0x21,	0x00,	0x00,	0x1E,	0x02,	0x3A,	0x80,	0x18,	0x71,	0x38,	0x2D,	0x40,
#0x58,	0x2C,	0x45,	0x00,	0xC4,	0x8E,	0x21,	0x00,	0x00,	0x1E,	0x00,	0x00,	0x00,	0xFC,	0x00,	0x54,
#0x56,	0x5F,	0x4D,	0x4F,	0x4E,	0x49,	0x54,	0x4F,	0x52,	0x0A,	0x20,	0x20,	0x00,	0x00,	0x00,	0xFD,
#0x00,	0x3B,	0x46,	0x1F,	0x8C,	0x3C,	0x00,	0x0A,	0x20,	0x20,	0x20,	0x20,	0x20,	0x20,	0x01,	0xC3,

#0x02,	0x03,	0x57,	0xF2,	0x5B,	0x05,	0x84,	0x03,	0x01,	0x12,	0x13,	0x14,	0x16,	0x07,	0x90,	0x1F,
#0x20,	0x22,	0x5D,	0x5F,	0x60,	0x61,	0x62,	0x64,	0x65,	0x66,	0x5E,	0x63,	0x02,	0x06,	0x11,	0x15,
#0x26,	0x09,	0x07,	0x07,	0x11,	0x07,	0x06,	0x83,	0x01,	0x00,	0x00,	0xE2,	0x00,	0xFF,	0x72,	0x03,
#0x0C,	0x00,	0x10,	0x00,	0x38,	0x44,	0x20,	0xC0,	0x84,	0x01,	0x02,	0x03,	0x04,	0x01,	0x41,	0x00,
#0x00,	0x67,	0xD8,	0x5D,	0xC4,	0x01,	0x78,	0x00,	0x03,	0xE3,	0x05,	0xC3,	0x00,	0xE5,	0x0F,	0x00,
#0x80,	0x19,	0x00,	0xE3,	0x06,	0x05,	0x01,	0x8C,	0x0A,	0xD0,	0x8A,	0x20,	0xE0,	0x2D,	0x10,	0x10,
#0x3E,	0x96,	0x00,	0xC4,	0x8E,	0x21,	0x00,	0x00,	0x18,	0x8C,	0x0A,	0xA0,	0x14,	0x51,	0xF0,	0x16,
#0x00,	0x26,	0x7C,	0x43,	0x00,	0xC4,	0x8E,	0x21,	0x00,	0x00,	0x98,	0x00,	0x00,	0x00,	0x00,	0xD9,

# 转换后的EDID.bin档中内容的显示格式
#00ff ffff ffff ff00 3674 3000 0100 0000
#0a18 0103 8073 4178 0acf 74a3 574c b023
#0948 4c00 0000 0101 01ff 01ff ff01 0101
#0101 0101 0120 08e8 0030 f270 5a80 b058
#8a00 c48e 2100 001e 023a 8018 7138 2d40
#582c 4500 c48e 2100 001e 0000 00fc 0054
#565f 4d4f 4e49 544f 520a 2020 0000 00fd
#003b 461f 8c3c 000a 2020 2020 2020 01c3
#0203 57f2 5b05 8403 0112 1314 1607 901f
#2022 5d5f 6061 6264 6566 5e63 0206 1115
#2609 0707 1107 0683 0100 00e2 00ff 7203
#0c00 1000 3844 20c0 8401 0203 0401 4100
#0067 d85d c401 7800 03e3 05c3 00e5 0f00
#8019 00e3 0605 018c 0ad0 8a20 e02d 1010
#3e96 00c4 8e21 0000 188c 0aa0 1451 f016
#0026 7c43 00c4 8e21 0000 9800 0000 00d9

rm -rf tempedid.txt

for (( i=1; i <= 16; i=i+2 ))
do
    istart=${i}
    #echo "istart:" ${istart}
    let iend=istart+1
    #echo "iend:" ${iend}
    #sed 's/0x//g' $1 | sed 's/[[:space:]]*//g' | tr '[A-Z]' '[a-z]' | sed '/^$/d' | sed 's/,/ /g' | cut -f${istart} -f${iend} -d " "  | sed 's/[[:space:]]//g'
    sed 's/0x//g' $1 | sed 's/[[:space:]]*//g' | tr '[A-Z]' '[a-z]' | sed '/^$/d' | sed 's/,/ /g' | cut -f${istart} -f${iend} -d " "  | sed 's/[[:space:]]//g' >> tempedid.txt
    echo >> tempedid.txt
    #result=`sed 's/0x//g' $1 | sed 's/[[:space:]]*//g' | tr '[A-Z]' '[a-z]' | sed '/^$/d' | sed 's/,/ /g' | cut -f${istart} -f${iend} -d " "  | sed 's/[[:space:]]//g' 2>&1`
    #echo $result
done

for (( m=1; m <=16; m=m+1 ))
do
    sun=""
    #echo "start m:"$m
    for (( k=0; k <8; k=k+1 ))
    do
        let rownumber=m+k*17
        #echo "rownumber:" $rownumber
        var=`cat tempedid.txt | sed -n "${rownumber}p"`
        sun="$sun $var"
        #echo "var:"$var
        if [ $k == 7 ];then
            echo $sun
        fi
    done
done

rm -rf tempedid.txt


